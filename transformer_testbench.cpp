#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <algorithm>
#include "transformer_layers.h"
#include <hls_stream.h>
#include <vector>


float ecg_array[198] =  {
        -0.644995f, -0.602840f, -0.528787f, -0.441597f, -0.358196f, -0.288033f,
        -0.231370f, -0.181591f, -0.129584f, -0.067728f, 0.007920f, 0.097509f,
        0.198559f, 0.307074f, 0.418057f, 0.525879f, 0.624813f, 0.709430f,
        0.775016f, 0.818548f, 0.840373f, 0.845916f, 0.846007f, 0.854600f,
        0.884163f, 0.940885f, 1.022422f, 1.119292f, 1.218227f, 1.304984f,
        1.366560f, 1.394294f, 1.387418f, 1.354294f, 1.309228f, 1.266173f,
        1.233558f, 1.213448f, 1.204214f, 1.203288f, 1.208036f, 1.215954f,
        1.225676f, 1.237680f, 1.253024f, 1.271186f, 1.289269f, 1.303000f,
        1.308359f, 1.303051f, 1.287692f, 1.265993f, 1.242778f, 1.220405f,
        1.196216f, 1.163457f, 1.115787f, 1.052610f, 0.981442f, 0.915436f,
        0.867424f, 0.844524f, 0.847070f, 0.871556f, 0.913859f, 0.969966f,
        1.034799f, 1.101397f, 1.161426f, 1.206243f, 1.228053f, 1.221439f,
        1.184885f, 1.121475f, 1.038425f, 0.945238f, 0.850817f, 0.761134f,
        0.679419f, 0.609026f, 0.556899f, 0.535027f, 0.558142f, 0.637612f,
        0.773790f, 0.950755f, 1.136895f, 1.292393f, 1.380686f, 1.378000f,
        1.276701f, 1.082674f, 0.809881f, 0.476094f, 0.102320f, -0.285524f,
        -0.657261f, -0.984010f, -1.245894f, -1.436825f, -1.563568f, -1.639914f,
        -1.678929f, -1.686936f, -1.661806f, -1.595968f, -1.482283f, -1.319984f,
        -1.118183f, -0.895366f, -0.674907f, -0.478628f, -0.321361f, -0.207976f,
        -0.132420f, -0.078304f, -0.021944f, 0.061158f, 0.187868f, 0.361218f,
        0.569935f, 0.793528f, 1.009954f, 1.202486f, 1.363271f, 1.492279f,
        1.592692f, 1.666458f, 1.713265f, 1.732833f, 1.728105f, 1.706957f,
        1.681293f, 1.663423f, 1.660818f, 1.671910f, 1.685908f, 1.687222f,
        1.662108f, 1.604102f, 1.516092f, 1.409222f, 1.300238f, 1.208007f,
        1.148801f, 1.130838f, 1.150675f, 1.194186f, 1.242156f, 1.277578f,
        1.290811f, 1.280407f, 1.250390f, 1.206834f, 1.156266f, 1.106068f,
        1.064861f, 1.041207f, 1.040721f, 1.063018f, 1.100479f, 1.140270f,
        1.169534f, 1.181540f, 1.178829f, 1.171075f, 1.169692f, 1.182953f,
        1.213303f, 1.256745f, 1.303792f, 1.341790f, 1.358546f, 1.346811f,
        1.307761f, 1.251073f, 1.190856f, 1.139928f, 1.106343f, 1.093693f,
        1.103196f, 1.134669f, 1.185183f, 1.246329f, 1.302790f, 1.334919f,
        1.325390f, 1.266465f, 1.163692f, 1.034405f, 0.902000f, 0.787989f,
        0.704547f, 0.650737f, 0.614213f, 0.577236f, 0.523896f, 0.445628f
};

float rr_array[2] ={0.516667f, 0.566667f};

void ecg_transformer_top(float ecg_data[198], 
                        float rr_data[2],
                        float predictions[5]);

// ====================================================================
// MAIN FUNCTION
// ====================================================================

int main() {
	    
	float predictions[5] = {0.0f, 0.0f, 0.0f, 0.0f, 0.0f};
    ecg_transformer_top(ecg_array, rr_array, predictions);
    
    printf(" predictions: ");
    for (int i = 0; i < 5; i++) printf("%.6f ", predictions[i]);
    
    return 0;
}


